package com.kh.test.run;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.Scanner;

public class InsertRun {

	public static void main(String[] args) {
		// 0) 필요한 변수 세팅
				Connection conn = null;
				Statement stmt = null;
				int result = 0;
				
				Scanner sc = new Scanner(System.in);
				
				System.out.print("사원번호를 입력해주세요 > ");
				int empId = sc.nextInt();
				sc.nextLine();
				
				System.out.print("사원이름을 입력해주세요 > ");
				String empName = sc.nextLine();
				
				System.out.print("주민등록번호를 입력해주세요 > ");
				String empNum = sc.nextLine();
				
				System.out.print("이메일을 입력해주세요 > ");
				String email = sc.nextLine();
				
				System.out.print("휴대폰번호를 입력해주세요 > ");
				int phoneNum = sc.nextInt();
				sc.nextLine();
				
				System.out.print("부서코드를 입력해주세요 > ");
				String deptCode = sc.nextLine();
				
				System.out.print("직급코드를 입력해주세요 > ");
				String jobCode = sc.nextLine();
				
				System.out.print("급여등급을 입력해주세요 > ");
				String salLevel = sc.nextLine();
				
				System.out.print("급여를 입력해주세요 > ");
				int salary = sc.nextInt();
				sc.nextLine();
				
				System.out.print("보너스를 입력해주세요 > ");
				double bonus = sc.nextDouble();
				sc.nextLine();
				
				System.out.print("관리자사번을 입력해주세요 > ");
				int managerId = sc.nextInt();
				sc.nextLine();
				
				
				System.out.print("재직여부 > ");
				char yesNo = sc.nextLine().charAt(0); 
				
				String sql = "INSERT"
						+      "INTO"
						+           "EMPLOYEE "
						+    "VALUES"
						+           "("
						+            "'" + empId + "', "
						+            "'" + empName +"',"
						+            "'" + empNum +"',"
						+            "'" + email +"',"
						+            phoneNum +","
						+            "'" + deptCode +"',"
						+            "'" + jobCode +"',"
						+            "'" + salLevel +"',"
					    +            salary +","
						+            bonus +","
						+            "'" + managerId 
						+            ", SYSDATE"
						+ 			 ", SYSDATE"
						+ 			 ",'" +  yesNo + ""
						+          "')";

				// EMP_ID, EMP_NAME, EMP_NO, EMAIL, PHONE, DEPT_CODE, JOB_CODE, SAL_LEVEL
				// , SALARY, BONUS, MANAGER_ID, HIRE_DATE, ENT_DATE, ENT_YN 
				
				
				try {
					Class.forName("oracle.jdbc.driver.OracleDriver");
					System.out.println("Driver등록 성공!");
					
			
					conn =DriverManager.getConnection("jdbc:oracle:thin:@115.90.212.20:10000:XE",
												"SSG13", "SSG131234");
					System.out.println("DB서버 접속 성공!");
					
					conn.setAutoCommit(false);
					
					stmt = conn.createStatement();
					System.out.println("Statement 객체 생성!");
					
				
					result = stmt.executeUpdate(sql);
					System.out.println("SQL문 실행 성공!");
					
				
					if(result > 0) { 
						conn.commit();
					}
					
					
				} catch (ClassNotFoundException e) {
					e.printStackTrace(); // 프로젝트에 OJDBC추가했나요??
					System.out.println("무조건 57행이 문제");
				} catch (SQLException e) {
					e.printStackTrace();
					System.out.println("사용자이름/비밀번호가 잘못됐습니다.      -> 63행 문제");
					System.out.println("부적합한 Oracle URL이 지정되었습니다. -> 62행문제");
					System.out.println("SQLSyntaxErrorException       -> SQL문 확인하기 51행문제");
					System.out.println("NullPointerException          -> JDBC객체를 확인하기");
				} finally {
					try {
						stmt.close();
						conn.close();
					}catch(SQLException e) {
						e.printStackTrace();
					}
				}
				
	}

}
